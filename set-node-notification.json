{
  "name": "Message Received Notification",
  "type": "n8n-nodes-base.set",
  "parameters": {
    "assignments": {
      "assignments": [
        {
          "id": "chatId",
          "name": "chatId",
          "value": "={{ $json.items[0].chatInfo.chatId }}",
          "type": "number"
        },
        {
          "id": "messageType",
          "name": "messageType", 
          "value": "={{ $json.messageType }}",
          "type": "string"
        },
        {
          "id": "userName",
          "name": "userName",
          "value": "={{ $json.items[0].userInfo.firstName }} {{ $json.items[0].userInfo.lastName }}",
          "type": "string"
        },
        {
          "id": "timestamp",
          "name": "timestamp",
          "value": "={{ $json.items[0].messageInfo.timestamp }}",
          "type": "string"
        },
        {
          "id": "hasMultipleTypes",
          "name": "hasMultipleTypes",
          "value": "={{ $json.items[0].hasMultipleTypes }}",
          "type": "boolean"
        },
        {
          "id": "response",
          "name": "response",
          "value": "ğŸ¤– **Mensaje Recibido y Procesado**\n\nğŸ“ **Tipo:** {{ $json.messageType }}{{ $json.items[0].hasMultipleTypes ? ' (mÃºltiples tipos detectados)' : '' }}\nğŸ‘¤ **De:** {{ $json.items[0].userInfo.firstName }} {{ $json.items[0].userInfo.lastName }}\nğŸ• **Hora:** {{ $now.format('HH:mm:ss') }}\nğŸ“Š **ID Mensaje:** {{ $json.items[0].messageInfo.messageId }}\n\n{{ $json.messageType === 'text' ? 'ğŸ’¬ Texto: \"' + $json.items[0].additionalInfo.textContent + '\"' : $json.messageType === 'photo' ? 'ğŸ“¸ Imagen recibida' : $json.messageType === 'video' ? 'ğŸ¥ Video recibido' : $json.messageType === 'voice' ? 'ğŸ¤ Mensaje de voz' : $json.messageType === 'audio' ? 'ğŸµ Audio recibido' : $json.messageType === 'document' ? 'ğŸ“„ Documento: ' + ($json.items[0].message.document.file_name || 'Sin nombre') : $json.messageType === 'sticker' ? 'ğŸ˜Š Sticker enviado' : $json.messageType === 'location' ? 'ğŸ“ UbicaciÃ³n compartida' : $json.messageType === 'contact' ? 'ğŸ‘¥ Contacto compartido' : $json.messageType === 'poll' ? 'ğŸ“Š Encuesta: \"' + $json.items[0].message.poll.question + '\"' : $json.messageType === 'command' ? 'âš™ï¸ Comando: ' + $json.items[0].additionalInfo.command : 'âœ¨ Contenido de tipo: ' + $json.messageType }}\n\nâœ… **Estado:** Procesado correctamente",
          "type": "string"
        }
      ]
    },
    "options": {}
  }
}

